test_annotation_palettes (unittest.loader._FailedTest.test_annotation_palettes) ... ERROR
test_cache_size_widget_defaults_to_100_in_advanced_settings (test_cache_settings.TestCacheSettings.test_cache_size_widget_defaults_to_100_in_advanced_settings) ... ok
test_image_mask_viewer_defaults_cache_size_to_100 (test_cache_settings.TestCacheSettings.test_image_mask_viewer_defaults_cache_size_to_100) ... ok
test_on_fov_change_refreshes_when_selection_present (test_cell_gallery.CellGalleryFovChangeTests.test_on_fov_change_refreshes_when_selection_present) ... ok
test_on_fov_change_skips_when_single_point_pending (test_cell_gallery.CellGalleryFovChangeTests.test_on_fov_change_skips_when_single_point_pending) ... ok
test_compose_canvas_handles_variable_tile_sizes (test_cell_gallery.ComposeCanvasTestCase.test_compose_canvas_handles_variable_tile_sizes) ... ok
test_all_cells_show_assigned_colors (test_cell_gallery.TestCellGalleryColors.test_all_cells_show_assigned_colors)
Verify all cells in gallery display their painted colors. ... ok
test_colors_persist_across_fovs (test_cell_gallery.TestCellGalleryColors.test_colors_persist_across_fovs)
Verify color assignments are global across FOVs. ... ok
test_default_color_for_unpainted_cells (test_cell_gallery.TestCellGalleryColors.test_default_color_for_unpainted_cells)
Verify unpainted cells show default mask color in uniform mode. ... ok
test_mixed_painted_and_unpainted_cells (test_cell_gallery.TestCellGalleryColors.test_mixed_painted_and_unpainted_cells)
Verify gallery handles mix of painted and unpainted cells. ... ok
test_neighboring_cells_show_painted_colors (test_cell_gallery.TestCellGalleryColors.test_neighboring_cells_show_painted_colors)
Verify that neighboring cells in crop region also show their painted colors. ... ok
test_uniform_color_shows_all_cells_in_crop (test_cell_gallery.TestCellGalleryColors.test_uniform_color_shows_all_cells_in_crop)
Verify that in uniform color mode, ALL cells in crop are shown. ... ok
test_error_placeholder_for_missing_mask (test_cell_gallery.TestErrorHandling.test_error_placeholder_for_missing_mask)
Verify error placeholder is returned when mask data is missing or corrupted. ... ok
test_warning_above_100_cells (test_cell_gallery.TestErrorHandling.test_warning_above_100_cells)
Verify warning is displayed when max_cells exceeds 100. ... ok
test_footer_layout_toggles_with_scatter_count (test_chart_footer_behavior.ChartDisplayFooterTests.test_footer_layout_toggles_with_scatter_count) ... ok
test_selection_does_not_forward_when_unlinked (test_chart_footer_behavior.ChartDisplayFooterTests.test_selection_does_not_forward_when_unlinked) ... ok
test_selection_forwards_to_cell_gallery_when_linked (test_chart_footer_behavior.ChartDisplayFooterTests.test_selection_forwards_to_cell_gallery_when_linked) ... ok
test_single_point_click_state_tracks_external_selection (test_chart_footer_behavior.ChartDisplayFooterTests.test_single_point_click_state_tracks_external_selection) ... ok
test_single_point_click_state_tracks_widget_selection (test_chart_footer_behavior.ChartDisplayFooterTests.test_single_point_click_state_tracks_widget_selection) ... ok
test_single_selection_does_not_update_cell_gallery_when_linked (test_chart_footer_behavior.ChartDisplayFooterTests.test_single_selection_does_not_update_cell_gallery_when_linked) ... ok
test_heatmap_survives_chart_refresh (test_chart_footer_behavior.HeatmapFooterPersistenceTests.test_heatmap_survives_chart_refresh) ... ok
test_batch_export_plugin_defaults_to_viewer_outline (test_export_fovs_batch.ExportFOVsBatchTests.test_batch_export_plugin_defaults_to_viewer_outline) ... ok
test_batch_export_plugin_ignores_viewer_update_when_overridden (test_export_fovs_batch.ExportFOVsBatchTests.test_batch_export_plugin_ignores_viewer_update_when_overridden) ... ok
test_batch_export_plugin_slider_override_is_local (test_export_fovs_batch.ExportFOVsBatchTests.test_batch_export_plugin_slider_override_is_local) ... ok
test_batch_export_plugin_syncs_with_viewer_when_not_overridden (test_export_fovs_batch.ExportFOVsBatchTests.test_batch_export_plugin_syncs_with_viewer_when_not_overridden) ... ok
test_capture_overlay_snapshot_and_rebuild (test_export_fovs_batch.ExportFOVsBatchTests.test_capture_overlay_snapshot_and_rebuild) ... ok
test_export_fovs_batch_missing_channel_reports_error (test_export_fovs_batch.ExportFOVsBatchTests.test_export_fovs_batch_missing_channel_reports_error) ... Export job item failed: item_id=FOV_A
Traceback (most recent call last):
  File "/omics/groups/OE0622/internal/ywu/UELer_public/ueler/export/job.py", line 177, in start
    payload = item.execute()
              ^^^^^^^^^^^^^^
  File "/omics/groups/OE0622/internal/ywu/UELer_public/ueler/viewer/main_viewer.py", line 2804, in worker
    raise ValueError("No valid channels found in this FOV")
ValueError: No valid channels found in this FOV
ok
test_export_fovs_batch_writes_file (test_export_fovs_batch.ExportFOVsBatchTests.test_export_fovs_batch_writes_file) ... FAIL
test_preview_single_cell_handles_scale_bar_without_error (test_export_fovs_batch.ExportFOVsBatchTests.test_preview_single_cell_handles_scale_bar_without_error) ... ok
test_resolve_marker_profile_uses_ui_channels_when_marker_set_empty (test_export_fovs_batch.ExportFOVsBatchTests.test_resolve_marker_profile_uses_ui_channels_when_marker_set_empty) ... ok
test_job_cancel_halts_remaining_items (test_export_job.ExportJobTests.test_job_cancel_halts_remaining_items) ... ok
test_job_failure_captures_traceback (test_export_job.ExportJobTests.test_job_failure_captures_traceback) ... Export job item failed: item_id=item1
Traceback (most recent call last):
  File "/omics/groups/OE0622/internal/ywu/UELer_public/ueler/export/job.py", line 177, in start
    payload = item.execute()
              ^^^^^^^^^^^^^^
  File "/omics/groups/OE0622/internal/ywu/UELer_public/tests/test_export_job.py", line 42, in worker
    raise RuntimeError("boom")
RuntimeError: boom
ok
test_job_success_merges_metadata (test_export_job.ExportJobTests.test_job_success_merges_metadata) ... ok
test_status_before_start_is_pending (test_export_job.ExportJobTests.test_status_before_start_is_pending) ... ok
test_available_fovs_filters_directories_with_tiff_files (test_fov_detection.TestFOVDetection.test_available_fovs_filters_directories_with_tiff_files)
Test that available_fovs logic only includes directories with TIFF files. ... ok
test_has_tiff_files_empty_directory (test_fov_detection.TestFOVDetection.test_has_tiff_files_empty_directory)
Test _has_tiff_files returns False for empty directory. ... ok
test_has_tiff_files_nonexistent_directory (test_fov_detection.TestFOVDetection.test_has_tiff_files_nonexistent_directory)
Test _has_tiff_files returns False for nonexistent directory. ... ok
test_has_tiff_files_with_rescaled_subdirectory (test_fov_detection.TestFOVDetection.test_has_tiff_files_with_rescaled_subdirectory)
Test _has_tiff_files checks rescaled subdirectory for TIFF files. ... ok
test_has_tiff_files_with_tif_files (test_fov_detection.TestFOVDetection.test_has_tiff_files_with_tif_files)
Test _has_tiff_files returns True when directory contains .tif files. ... ok
test_has_tiff_files_with_tiff_files (test_fov_detection.TestFOVDetection.test_has_tiff_files_with_tiff_files)
Test _has_tiff_files returns True when directory contains .tiff files. ... ok
test_has_tiff_files_without_tiff_files (test_fov_detection.TestFOVDetection.test_has_tiff_files_without_tiff_files)
Test _has_tiff_files returns False when directory has no TIFF files. ... ok
test_observable_notifies_on_value_change (test_gallery_heatmap_integration.TestHeatmapIntegration.test_observable_notifies_on_value_change)
Verify Observable notifies observers when value changes. ... ERROR
test_random_sampling_with_large_selection (test_gallery_heatmap_integration.TestHeatmapIntegration.test_random_sampling_with_large_selection)
Verify random sampling works when selection exceeds max. ... ok
test_set_selected_cells_triggers_plot (test_gallery_heatmap_integration.TestHeatmapIntegration.test_set_selected_cells_triggers_plot)
Verify set_selected_cells updates the observable and triggers rendering. ... ok
test_redraw_replays_display_when_output_empty (test_heatmap_selection.HeatmapCanvasRestoreTests.test_redraw_replays_display_when_output_empty) ... ok
test_redraw_returns_false_without_artifacts (test_heatmap_selection.HeatmapCanvasRestoreTests.test_redraw_returns_false_without_artifacts) ... ok
test_redraw_skips_display_when_widget_view_present (test_heatmap_selection.HeatmapCanvasRestoreTests.test_redraw_skips_display_when_widget_view_present) ... ok
test_restore_footer_canvas_prefers_cached_redraw (test_heatmap_selection.HeatmapCanvasRestoreTests.test_restore_footer_canvas_prefers_cached_redraw) ... ok
test_horizontal_patches_update_after_reassignment (test_heatmap_selection.HeatmapPatchRenderingTests.test_horizontal_patches_update_after_reassignment) ... ok
test_vertical_layout_uses_horizontal_spans (test_heatmap_selection.HeatmapPatchRenderingTests.test_vertical_layout_uses_horizontal_spans) ... ok
test_empty_selection_clears_highlight (test_heatmap_selection.HeatmapScatterSelectionTests.test_empty_selection_clears_highlight) ... ok
test_missing_orientation_triggers_replot (test_heatmap_selection.HeatmapScatterSelectionTests.test_missing_orientation_triggers_replot) ... ok
test_selection_ignored_when_chart_link_disabled (test_heatmap_selection.HeatmapScatterSelectionTests.test_selection_ignored_when_chart_link_disabled) ... ok
test_selection_updates_highlight_without_replot (test_heatmap_selection.HeatmapScatterSelectionTests.test_selection_updates_highlight_without_replot) ... ok
test_vertical_ticks_keep_existing_ordering (test_heatmap_selection.HeatmapTickAlignmentTests.test_vertical_ticks_keep_existing_ordering) ... ok
test_wide_ticks_centered_on_cells (test_heatmap_selection.HeatmapTickAlignmentTests.test_wide_ticks_centered_on_cells) ... ok
test_negative_small_value_preserves_sign (test_image_display_tooltip.TooltipFormattingTests.test_negative_small_value_preserves_sign) ... ok
test_regular_value_uses_fixed_point (test_image_display_tooltip.TooltipFormattingTests.test_regular_value_uses_fixed_point) ... ok
test_small_value_uses_scientific_notation (test_image_display_tooltip.TooltipFormattingTests.test_small_value_uses_scientific_notation) ... ok
test_zero_value_stays_zero (test_image_display_tooltip.TooltipFormattingTests.test_zero_value_stays_zero) ... ok
test_color_normalization_helpers (test_mask_color_sets.MaskColorPersistenceTests.test_color_normalization_helpers) ... ok
test_load_applies_identifier_and_default_color (test_mask_color_sets.MaskColorPersistenceTests.test_load_applies_identifier_and_default_color) ... ok
test_registry_persistence (test_mask_color_sets.MaskColorPersistenceTests.test_registry_persistence) ... ok
test_round_trip_save_load (test_mask_color_sets.MaskColorPersistenceTests.test_round_trip_save_load) ... ok
test_serialize_applies_defaults (test_mask_color_sets.MaskColorPersistenceTests.test_serialize_applies_defaults) ... ok
test_serialize_custom_default (test_mask_color_sets.MaskColorPersistenceTests.test_serialize_custom_default) ... ok
test_colors_available_before_loading_fov (test_painted_colors_all_fovs.TestPaintedColorsAllFovs.test_colors_available_before_loading_fov)
Test that gallery can access colors before loading the FOV in viewer. ... ok
test_colors_registered_for_all_fovs (test_painted_colors_all_fovs.TestPaintedColorsAllFovs.test_colors_registered_for_all_fovs)
Test that applying colors registers them for all FOVs, not just current. ... ok
test_hidden_classes_registered_for_all_fovs (test_painted_colors_all_fovs.TestPaintedColorsAllFovs.test_hidden_classes_registered_for_all_fovs)
Test that hidden classes (default color) are also registered globally. ... ok
test_outline_scaling_respects_downsample_factor (test_rendering.RenderingHelpersTests.test_outline_scaling_respects_downsample_factor) ... ok
test_render_crop_to_array_uses_requested_region (test_rendering.RenderingHelpersTests.test_render_crop_to_array_uses_requested_region) ... ok
test_render_fov_outline_preserves_label_boundaries (test_rendering.RenderingHelpersTests.test_render_fov_outline_preserves_label_boundaries) ... ok
test_render_fov_outline_thickness_expands_boundaries (test_rendering.RenderingHelpersTests.test_render_fov_outline_thickness_expands_boundaries) ... ok
test_render_fov_to_array_applies_annotation (test_rendering.RenderingHelpersTests.test_render_fov_to_array_applies_annotation) ... ok
test_render_fov_to_array_combines_channels (test_rendering.RenderingHelpersTests.test_render_fov_to_array_combines_channels) ... ok
test_render_fov_to_array_outline_mode_without_skimage (test_rendering.RenderingHelpersTests.test_render_fov_to_array_outline_mode_without_skimage) ... ok
test_render_fov_to_array_with_masks (test_rendering.RenderingHelpersTests.test_render_fov_to_array_with_masks) ... ok
test_render_fov_to_array_with_translucent_masks (test_rendering.RenderingHelpersTests.test_render_fov_to_array_with_translucent_masks) ... ok
test_render_roi_to_array_accepts_center_width_strings (test_rendering.RenderingHelpersTests.test_render_roi_to_array_accepts_center_width_strings) ... ok
test_render_roi_to_array_accepts_string_coordinates (test_rendering.RenderingHelpersTests.test_render_roi_to_array_accepts_string_coordinates) ... ok
test_render_roi_to_array_falls_back_when_bounds_invalid (test_rendering.RenderingHelpersTests.test_render_roi_to_array_falls_back_when_bounds_invalid) ... ok
test_render_roi_to_array_requires_valid_definition (test_rendering.RenderingHelpersTests.test_render_roi_to_array_requires_valid_definition) ... ok
test_render_roi_to_array_rounds_up_region_bounds (test_rendering.RenderingHelpersTests.test_render_roi_to_array_rounds_up_region_bounds) ... ok
test_scale_outline_thickness_clamps_minimum (test_rendering.RenderingHelpersTests.test_scale_outline_thickness_clamps_minimum) ... ok
test_browser_expression_compilation (test_roi_manager_tags.ROIManagerTagsTests.test_browser_expression_compilation) ... ok
test_browser_output_widget_scrolls_within_fixed_height (test_roi_manager_tags.ROIManagerTagsTests.test_browser_output_widget_scrolls_within_fixed_height) ... ok
test_browser_root_layout_can_shrink (test_roi_manager_tags.ROIManagerTagsTests.test_browser_root_layout_can_shrink) ... ok
test_capture_forwards_custom_tags (test_roi_manager_tags.ROIManagerTagsTests.test_capture_forwards_custom_tags) ... ok
test_combobox_entry_creates_new_tag (test_roi_manager_tags.ROIManagerTagsTests.test_combobox_entry_creates_new_tag) ... ok
test_combobox_ignores_duplicate_entries (test_roi_manager_tags.ROIManagerTagsTests.test_combobox_ignores_duplicate_entries) ... ok
test_expression_insertion_replaces_highlighted_range (test_roi_manager_tags.ROIManagerTagsTests.test_expression_insertion_replaces_highlighted_range) ... ok
test_expression_insertion_respects_cached_selection (test_roi_manager_tags.ROIManagerTagsTests.test_expression_insertion_respects_cached_selection) ... ok
test_expression_restores_tail_selection_for_backend_updates (test_roi_manager_tags.ROIManagerTagsTests.test_expression_restores_tail_selection_for_backend_updates) ... ok
test_gallery_layout_respects_width_ratio_and_columns (test_roi_manager_tags.ROIManagerTagsTests.test_gallery_layout_respects_width_ratio_and_columns) ... ok
test_new_tag_persists_when_restrictions_apply (test_roi_manager_tags.ROIManagerTagsTests.test_new_tag_persists_when_restrictions_apply) ... ok
test_new_tags_extend_allowed_pool (test_roi_manager_tags.ROIManagerTagsTests.test_new_tags_extend_allowed_pool) ... ok
test_select_downsample_factor_clamps_against_allowed_list (test_roi_manager_tags.ROIManagerTagsTests.test_select_downsample_factor_clamps_against_allowed_list) ... ok
test_string_payload_ignores_whitespace_and_duplicates (test_roi_manager_tags.ROIManagerTagsTests.test_string_payload_ignores_whitespace_and_duplicates) ... ok
test_string_payload_merges_with_existing_tags (test_roi_manager_tags.ROIManagerTagsTests.test_string_payload_merges_with_existing_tags) ... ok
test_tags_widget_allows_new_entries (test_roi_manager_tags.ROIManagerTagsTests.test_tags_widget_allows_new_entries) ... ok
test_thumbnail_downsample_defaults_to_unity_for_small_images (test_roi_manager_tags.ROIManagerTagsTests.test_thumbnail_downsample_defaults_to_unity_for_small_images) ... ok
test_thumbnail_downsample_falls_back_to_fov_dimensions (test_roi_manager_tags.ROIManagerTagsTests.test_thumbnail_downsample_falls_back_to_fov_dimensions) ... ok
test_thumbnail_downsample_uses_roi_viewport_dimensions (test_roi_manager_tags.ROIManagerTagsTests.test_thumbnail_downsample_uses_roi_viewport_dimensions) ... ok
test_load_cell_table_from_path_refreshes_ui (test_runner.RunnerSmokeTest.test_load_cell_table_from_path_refreshes_ui) ... ok
test_load_cell_table_validation (test_runner.RunnerSmokeTest.test_load_cell_table_validation) ... ok
test_load_cell_table_with_dataframe_and_display (test_runner.RunnerSmokeTest.test_load_cell_table_with_dataframe_and_display) ... ok
test_module_reexports_runner (test_runner.RunnerSmokeTest.test_module_reexports_runner) ... ok
test_run_viewer_instantiates_and_displays (test_runner.RunnerSmokeTest.test_run_viewer_instantiates_and_displays) ... ok
test_run_viewer_respects_flags (test_runner.RunnerSmokeTest.test_run_viewer_respects_flags) ... ok
test_compute_scale_bar_spec_handles_millimetres (test_scale_bar_helper.ScaleBarHelperTests.test_compute_scale_bar_spec_handles_millimetres) ... ok
test_compute_scale_bar_spec_rejects_invalid_inputs (test_scale_bar_helper.ScaleBarHelperTests.test_compute_scale_bar_spec_rejects_invalid_inputs) ... ok
test_compute_scale_bar_spec_rounds_to_engineering_lengths (test_scale_bar_helper.ScaleBarHelperTests.test_compute_scale_bar_spec_rounds_to_engineering_lengths) ... ok
test_compute_scale_bar_spec_scales_when_pixel_size_expands (test_scale_bar_helper.ScaleBarHelperTests.test_compute_scale_bar_spec_scales_when_pixel_size_expands) ... FAIL
test_effective_pixel_size_nm_scales_with_downsample (test_scale_bar_helper.ScaleBarHelperTests.test_effective_pixel_size_nm_scales_with_downsample) ... ok
test_set_categorical_colors_aligns_with_indices (test_scatter_widget_dependencies.ScatterWidgetColoringTests.test_set_categorical_colors_aligns_with_indices) ... ok
test_import_guard_surfaces_anywidget_instructions (test_scatter_widget_dependencies.ScatterWidgetDependencyTests.test_import_guard_surfaces_anywidget_instructions) ... ok
test_aliases_mirror_legacy_modules (test_shims_imports.TestShimImportCompatibility.test_aliases_mirror_legacy_modules) ... 
  test_aliases_mirror_legacy_modules (test_shims_imports.TestShimImportCompatibility.test_aliases_mirror_legacy_modules) (alias='ueler.constants', target='constants') ... FAIL
  test_aliases_mirror_legacy_modules (test_shims_imports.TestShimImportCompatibility.test_aliases_mirror_legacy_modules) (alias='ueler.data_loader', target='data_loader') ... FAIL
test_from_import_core_symbol (test_shims_imports.TestShimImportCompatibility.test_from_import_core_symbol) ... ok
test_from_import_plugin_symbol (test_shims_imports.TestShimImportCompatibility.test_from_import_plugin_symbol) ... ok
test_top_level_utility_alias (test_shims_imports.TestShimImportCompatibility.test_top_level_utility_alias) ... FAIL
test_conjunction (test_tag_expression.TagExpressionTests.test_conjunction) ... ok
test_disjunction (test_tag_expression.TagExpressionTests.test_disjunction) ... ok
test_invalid_expression_raises (test_tag_expression.TagExpressionTests.test_invalid_expression_raises) ... ok
test_negation (test_tag_expression.TagExpressionTests.test_negation) ... ok
test_parentheses_precedence (test_tag_expression.TagExpressionTests.test_parentheses_precedence) ... ok
test_supports_quotes (test_tag_expression.TagExpressionTests.test_supports_quotes) ... ok
test_build_wide_plugin_pane_wraps_control_and_content (test_wide_plugin_panel.WidePanelHelperTests.test_build_wide_plugin_pane_wraps_control_and_content) ... ok
test_cached_heatmap_requests_refresh_when_pane_reused (test_wide_plugin_panel.WidePanelHelperTests.test_cached_heatmap_requests_refresh_when_pane_reused) ... ok
test_heatmap_pane_reused_when_chart_relocations_trigger_refresh (test_wide_plugin_panel.WidePanelHelperTests.test_heatmap_pane_reused_when_chart_relocations_trigger_refresh) ... ok
test_toggle_moves_plugin_between_side_and_bottom (test_wide_plugin_panel.WidePanelHelperTests.test_toggle_moves_plugin_between_side_and_bottom) ... ok

======================================================================
ERROR: test_annotation_palettes (unittest.loader._FailedTest.test_annotation_palettes)
----------------------------------------------------------------------
ImportError: Failed to import test module: test_annotation_palettes
Traceback (most recent call last):
  File "/usr/lib/python3.11/unittest/loader.py", line 407, in _find_test_path
    module = self._get_module_from_name(name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/unittest/loader.py", line 350, in _get_module_from_name
    __import__(name)
  File "/omics/groups/OE0622/internal/ywu/UELer_public/tests/test_annotation_palettes.py", line 332, in <module>
    from viewer.main_viewer import (
  File "/omics/groups/OE0622/internal/ywu/UELer_public/viewer/main_viewer.py", line 9, in <module>
    _target = importlib.import_module("ueler.viewer.main_viewer")
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/omics/groups/OE0622/internal/ywu/UELer_public/ueler/viewer/main_viewer.py", line 29, in <module>
    from ueler.image_utils import (
  File "/omics/groups/OE0622/internal/ywu/UELer_public/ueler/_compat.py", line 127, in exec_module
    target_module = importlib.import_module(target_name)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.11/importlib/__init__.py", line 126, in import_module
    return _bootstrap._gcd_import(name[level:], package, level)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/omics/groups/OE0622/internal/ywu/UELer_public/image_utils.py", line 90, in <module>
    from skimage.io import imread, imsave
  File "/omics/groups/OE0622/internal/ywu/UELer_public/.venv/lib/python3.11/site-packages/skimage/io/__init__.py", line 5, in <module>
    from .manage_plugins import *
  File "/omics/groups/OE0622/internal/ywu/UELer_public/.venv/lib/python3.11/site-packages/skimage/io/manage_plugins.py", line 26, in <module>
    from .collection import imread_collection_wrapper
  File "/omics/groups/OE0622/internal/ywu/UELer_public/.venv/lib/python3.11/site-packages/skimage/io/collection.py", line 12, in <module>
    from tifffile import TiffFile
ImportError: cannot import name 'TiffFile' from 'tifffile' (unknown location)


======================================================================
ERROR: test_observable_notifies_on_value_change (test_gallery_heatmap_integration.TestHeatmapIntegration.test_observable_notifies_on_value_change)
Verify Observable notifies observers when value changes.
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/omics/groups/OE0622/internal/ywu/UELer_public/tests/test_gallery_heatmap_integration.py", line 62, in test_observable_notifies_on_value_change
    self.gallery.data.selected_cells.value = test_indices
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/omics/groups/OE0622/internal/ywu/UELer_public/ueler/viewer/observable.py", line 34, in value
    self.notify_observers()
  File "/omics/groups/OE0622/internal/ywu/UELer_public/ueler/viewer/observable.py", line 25, in notify_observers
    observer(self._value)
  File "/omics/groups/OE0622/internal/ywu/UELer_public/ueler/viewer/plugin/cell_gallery.py", line 384, in on_selected_indices_change
    self.plot_gellery()
  File "/omics/groups/OE0622/internal/ywu/UELer_public/ueler/viewer/decorators.py", line 37, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/omics/groups/OE0622/internal/ywu/UELer_public/ueler/viewer/plugin/cell_gallery.py", line 310, in plot_gellery
    self._draw_gallery(canvas, n, displayed_indices, ui_values.crop_width)
  File "/omics/groups/OE0622/internal/ywu/UELer_public/ueler/viewer/plugin/cell_gallery.py", line 212, in _draw_gallery
    plt.show(fig)
  File "/omics/groups/OE0622/internal/ywu/UELer_public/.venv/lib/python3.11/site-packages/matplotlib/pyplot.py", line 613, in show
    return _get_backend_mod().show(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
TypeError: _Backend.show() takes 1 positional argument but 2 were given

======================================================================
FAIL: test_export_fovs_batch_writes_file (test_export_fovs_batch.ExportFOVsBatchTests.test_export_fovs_batch_writes_file)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/omics/groups/OE0622/internal/ywu/UELer_public/tests/test_export_fovs_batch.py", line 532, in test_export_fovs_batch_writes_file
    self.assertTrue(expected_file.exists(), "Expected export file was not created")
AssertionError: False is not true : Expected export file was not created

======================================================================
FAIL: test_compute_scale_bar_spec_scales_when_pixel_size_expands (test_scale_bar_helper.ScaleBarHelperTests.test_compute_scale_bar_spec_scales_when_pixel_size_expands)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/omics/groups/OE0622/internal/ywu/UELer_public/tests/test_scale_bar_helper.py", line 33, in test_compute_scale_bar_spec_scales_when_pixel_size_expands
    self.assertAlmostEqual(doubled.pixel_length, base.pixel_length / 2.0)
AssertionError: 20.0 != 10.0 within 7 places (10.0 difference)

======================================================================
FAIL: test_aliases_mirror_legacy_modules (test_shims_imports.TestShimImportCompatibility.test_aliases_mirror_legacy_modules) (alias='ueler.constants', target='constants')
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/omics/groups/OE0622/internal/ywu/UELer_public/tests/test_shims_imports.py", line 51, in test_aliases_mirror_legacy_modules
    self.assertEqual(alias_module.__name__, target_module.__name__)
AssertionError: 'ueler.constants' != 'constants'
- ueler.constants
? ------
+ constants


======================================================================
FAIL: test_aliases_mirror_legacy_modules (test_shims_imports.TestShimImportCompatibility.test_aliases_mirror_legacy_modules) (alias='ueler.data_loader', target='data_loader')
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/omics/groups/OE0622/internal/ywu/UELer_public/tests/test_shims_imports.py", line 51, in test_aliases_mirror_legacy_modules
    self.assertEqual(alias_module.__name__, target_module.__name__)
AssertionError: 'ueler.data_loader' != 'data_loader'
- ueler.data_loader
? ------
+ data_loader


======================================================================
FAIL: test_top_level_utility_alias (test_shims_imports.TestShimImportCompatibility.test_top_level_utility_alias)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/omics/groups/OE0622/internal/ywu/UELer_public/tests/test_shims_imports.py", line 83, in test_top_level_utility_alias
    self.assertIs(shim_constants, legacy_constants)
AssertionError: <module 'ueler.constants' from '/omics/groups/OE0622/internal/ywu/UELer_public/ueler/constants.py'> is not <module 'constants' from '/omics/groups/OE0622/internal/ywu/UELer_public/constants.py'>

----------------------------------------------------------------------
Ran 130 tests in 0.213s

FAILED (failures=5, errors=2)
[ERROR] Failed to render tile for index=10: not enough values to unpack (expected 2, got 0)
[ERROR] Failed to render tile for index=20: not enough values to unpack (expected 2, got 0)
[ERROR] Failed to render tile for index=30: not enough values to unpack (expected 2, got 0)
200 cells selected, which exceeds the maximum number of cells to display.
Randomly sampled 50 cells for display.
Selected indices have changed.
Selected indices have changed.
Selected indices have changed.
Selected indices have changed.
Selected indices have changed.
Selected indices have changed.
Loaded color set 'Example' from /tmp/tmpil843z1v/example.maskcolors.json.
⚠️ Cell table is not available.
Masks updated with class-based colors.
Masks updated with class-based colors.
Masks updated with class-based colors.
